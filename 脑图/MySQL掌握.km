{"root":{"data":{"id":"bssdve6wu7c0","created":1553093991984,"text":"MySQL掌握","expandState":"expand"},"children":[{"data":{"id":"bssdvqonw0w0","created":1553094019178,"text":"MyISAM和InnoDB区别","hyperlink":"https://juejin.im/post/5b1685bef265da6e5c3c1c34#heading-4","hyperlinkTitle":"参考","expandState":"expand"},"children":[{"data":{"id":"bssdw4certs0","created":1553094048913,"text":"MyISAM特点","note":"MySQL5.5版本前的默认存储引擎，5.6引入了InnoDB\n\n并非InnoDB是最好的选择，有些情况下适合使用MyISAM\n> MyISAM更适合读密集的表，而InnoDB更适合写密集的的表。 在数据库做主从分离的情况下，经常选择MyISAM作为从库的存储引擎","expandState":"expand"},"children":[{"data":{"id":"bssdw8gais00","created":1553094057854,"text":"不支持事务","priority":1,"expandState":"expand"},"children":[]},{"data":{"id":"bssdwdi8br40","created":1553094068856,"text":"表锁，不支持行锁","note":"读取时对需要读到的所有表加锁，写入时则对表加排他锁\n\n读操作同时也支持向表中插入数据记录","priority":1,"expandState":"expand"},"children":[]},{"data":{"id":"bssdwqt2w6o0","created":1553094097810,"text":"不支持外键","expandState":"expand"},"children":[]},{"data":{"id":"bssdxyycouo0","created":1553094193907,"text":"支持fulltext索引","expandState":"expand"},"children":[]},{"data":{"id":"bssdy7f5w9s0","created":1553094212338,"text":"对索引延迟更新，提升写的性能","expandState":"expand"},"children":[]},{"data":{"id":"bssdysp7bbc0","created":1553094258657,"text":"对不会修改的表支持压缩表，减少磁盘空间占用","priority":2,"expandState":"expand"},"children":[]},{"data":{"id":"bsse2o9qfq80","created":1553094562471,"text":"不支持崩溃后安全恢复","priority":2,"expandState":"expand"},"children":[]}]},{"data":{"id":"bsse15977zk0","created":1553094442716,"text":"InnoDB特点","expandState":"expand"},"children":[{"data":{"id":"bsse1nk8m000","created":1553094482566,"text":"支持事务","expandState":"expand"},"children":[]},{"data":{"id":"bsse1slshmg0","created":1553094493543,"text":"支持外键","expandState":"expand"},"children":[]},{"data":{"id":"bsse1vv1dow0","created":1553094500633,"text":"默认支持行锁","note":"并发性能更好（采用MVCC来支持高并发），但可能会造成死锁","expandState":"expand"},"children":[]},{"data":{"id":"bsse27zit200","created":1553094527025,"text":"支持崩溃后的安全恢复","expandState":"expand"},"children":[]},{"data":{"id":"bsse3nl8ogw0","created":1553094639354,"text":"5.6版本后InnoDB也支持fulltext索引","expandState":"expand"},"children":[]}]},{"data":{"id":"bsse59hlitc0","created":1553094765388,"text":"其他对比","expandState":"expand"},"children":[{"data":{"id":"bsse5chv8800","created":1553094771934,"text":"MyISAM会缓存表的行数及其他表的元数据信息metadata","expandState":"expand"},"children":[]}]}]},{"data":{"id":"bsssh99wle00","created":1553135200831,"text":"行锁和表锁","note":"锁，一种协调多进程或多线程并发访问资源的一种机制","expandState":"expand"},"children":[{"data":{"id":"bsssk45qwmg0","created":1553135424788,"text":"表锁","expandState":"expand"},"children":[{"data":{"id":"bsssk8k4cgg0","created":1553135434364,"text":"每次操作锁住整张表","expandState":"expand"},"children":[]},{"data":{"id":"bssske2hah40","created":1553135446359,"text":"开销小、加锁快","expandState":"expand"},"children":[]},{"data":{"id":"bssskgdz9m80","created":1553135451407,"text":"无死锁","expandState":"expand"},"children":[]},{"data":{"id":"bssskwffna80","created":1553135486324,"text":"锁定粒度大，发生锁冲突的概率最高，并发度最低","expandState":"expand"},"children":[]}]},{"data":{"id":"bsssk6a44k00","created":1553135429406,"text":"行锁","expandState":"expand"},"children":[{"data":{"id":"bssslfoukso0","created":1553135528252,"text":"每次操作锁住一行记录","expandState":"expand"},"children":[]},{"data":{"id":"bsssll43afk0","created":1553135540058,"text":"开销大、加锁慢","expandState":"expand"},"children":[]},{"data":{"id":"bssslpnc3v40","created":1553135549928,"text":"会发生死锁","expandState":"expand"},"children":[]},{"data":{"id":"bssslwubl2w0","created":1553135565588,"text":"锁定粒度最小，发生锁冲突的概率最低，并发度也最高","expandState":"expand"},"children":[]}]}]},{"data":{"id":"bsssn78rz0o0","created":1553135666594,"text":"索引分类","hyperlink":"http://benjaminwhx.com/2018/02/26/MySQL%E7%B4%A2%E5%BC%95%E5%8E%9F%E7%90%86%E4%BB%A5%E5%8F%8A%E6%85%A2%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96/#1%E3%80%81%E7%B4%A2%E5%BC%95%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%BB%A5%E5%8F%8A%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80","hyperlinkTitle":"MySQL索引原理以及慢查询优化","note":"用于优化查询，适合where、join中的条件","expandState":"expand"},"children":[{"data":{"id":"bsssnbo5dk00","created":1553135676231,"text":"聚集索引和非聚集索引","image":"https://img-blog.csdn.net/20160127144445485","imageTitle":"","imageSize":{"width":200,"height":104},"hyperlink":"https://www.cnblogs.com/aspnethot/articles/1504082.html","hyperlinkTitle":"","expandState":"expand"},"children":[{"data":{"id":"bsstfufq5280","created":1553137911277,"text":"聚集索引","note":"数据**按照索引的顺序进行组织和排列**，这种就是聚集索引\n> 简单点说就是数据会按照索引的顺序存储\n\n其他一般的索引就是非聚集索引","expandState":"expand"},"children":[{"data":{"id":"bsstiqvwp800","created":1553138138641,"text":"InnoDB中主键索引就是聚集索引","expandState":"expand"},"children":[{"data":{"id":"bst3d61p6s00","created":1553165912557,"text":"默认按照主键为聚集索引","expandState":"expand"},"children":[]},{"data":{"id":"bst3dier66g0","created":1553165939468,"text":"  如果没有定义主键，尝试选择唯一的非空索引代替为聚集索引","expandState":"expand"},"children":[]},{"data":{"id":"bst3ea1ahw80","created":1553165999604,"text":"以上都没有的话，InnoDB会默认定义隐藏的主键为聚集索引","expandState":"expand"},"children":[]}]},{"data":{"id":"bsstokltqy00","created":1553138595156,"text":"索引的叶子节点是存放数据","expandState":"expand"},"children":[]},{"data":{"id":"bsstq9wwybk0","created":1553138728610,"text":"聚集索引一个表只能有一个，而非聚集索引一个表可以存在多个","expandState":"expand"},"children":[]},{"data":{"id":"bsstqm2rons0","created":1553138755085,"text":"聚集索引存储记录是物理上连续存在，而非聚集索引是逻辑上的连续，物理存储并不连续","expandState":"expand"},"children":[]},{"data":{"id":"bst3apxuooo0","created":1553165720767,"text":"聚集索引查询速度快，写入操作比较费时","expandState":"expand"},"children":[]}]},{"data":{"id":"bsstfx9whls0","created":1553137917455,"text":"非聚集索引","expandState":"expand"},"children":[{"data":{"id":"bsstizmnaww0","created":1553138157672,"text":"MyISAM只有非聚集索引","expandState":"expand"},"children":[]},{"data":{"id":"bsstovhznsg0","created":1553138618868,"text":"叶子节点任然是索引节点，不过会有指针指向数据块","expandState":"expand"},"children":[]}]}]},{"data":{"id":"bst3sskwvhc0","created":1553167137070,"text":"hash索引","expandState":"expand"},"children":[]},{"data":{"id":"bst3szg51lc0","created":1553167152019,"text":"fulltext索引","expandState":"expand"},"children":[]},{"data":{"id":"bst3t2y6t9k0","created":1553167159642,"text":"主键索引","expandState":"expand"},"children":[]},{"data":{"id":"bst3t6pfyfs0","created":1553167167819,"text":"唯一索引","expandState":"expand"},"children":[]},{"data":{"id":"bst3t8rh0s80","created":1553167172296,"text":"普通索引、组合索引","expandState":"expand"},"children":[]},{"data":{"id":"bst1bbp1q1k0","created":1553160125904,"text":"索引使用和优化","hyperlink":"https://juejin.im/post/5b68e3636fb9a04fd343ba99#heading-4","hyperlinkTitle":"深入浅出MySQL","expandState":"expand"},"children":[{"data":{"id":"bst3z762kog0","created":1553167639010,"text":"索引适合where和on子句中的列","expandState":"expand"},"children":[]},{"data":{"id":"bst3gn5mfps0","created":1553166184892,"text":"组合索引默认遵守最左匹配原则","expandState":"expand"},"children":[]},{"data":{"id":"bst3h2di7yg0","created":1553166218020,"text":"对于like \"%text%\"这种%在开头的不会使用索引，text%会","expandState":"expand"},"children":[]},{"data":{"id":"bst3hxvnhug0","created":1553166286598,"text":"索引用于=、in这类比较的精确匹配","expandState":"expand"},"children":[]},{"data":{"id":"bst438cjmgg0","created":1553167955035,"text":"union、or也可以命中索引","expandState":"expand"},"children":[{"data":{"id":"bst43lir7uw0","created":1553167983708,"text":"查询的CPU消耗：or > in >union","expandState":"expand"},"children":[]},{"data":{"id":"bst4409on000","created":1553168015811,"text":"用or分割开的条件，or前条件有索引，or后的列没有索引，那么涉及的索引不会被用到","expandState":"expand"},"children":[]}]},{"data":{"id":"bst44ly68a00","created":1553168063005,"text":"负向条件查询不能使用索引，可以优化为 in 查询","note":"> !=、<>、not in、not exists、not like都是负向条件\n\n对于数据较为均匀的场景是会失效","expandState":"expand"},"children":[{"data":{"id":"bst46q43wu00","created":1553168228799,"text":"不一定的，以数据量定，mysql会自动判断","hyperlink":"https://segmentfault.com/q/1010000009426506/a-1020000009432008","hyperlinkTitle":"","expandState":"expand"},"children":[]}]},{"data":{"id":"bst3i9x5b480","created":1553166312810,"text":"索引也可用与范围查询","expandState":"expand"},"children":[{"data":{"id":"bst3ifkcyco0","created":1553166325097,"text":"但对字段进行范围查询>、=、<、between and等，其后的列就不能使用索引","expandState":"expand"},"children":[]},{"data":{"id":"bst48uhtc480","created":1553168395063,"text":"范围查询和等值查询同时存在，优先匹配等值查询列的索引","expandState":"expand"},"children":[]}]},{"data":{"id":"bst3ju868io0","created":1553166435376,"text":"用了函数或表达式不会使用索引","expandState":"expand"},"children":[]},{"data":{"id":"bst4gha23sg0","created":1553168993209,"text":"is null可以命中索引，is not null反而不能","expandState":"expand"},"children":[]},{"data":{"id":"bst3kuu812w0","created":1553166515074,"text":"选择哪些字段建立索引","expandState":"expand"},"children":[{"data":{"id":"bst3l46oktc0","created":1553166535418,"text":"适合字段分布均匀的，像性别就不适合","expandState":"expand"},"children":[]},{"data":{"id":"bst4fd0ah1c0","created":1553168905547,"text":"选择的索引列不允许为null，或者组合索引不允许字段全为null","expandState":"expand"},"children":[]},{"data":{"id":"bst4gz7qjs00","created":1553169032251,"text":"不适合选经常更新的字段作为索引","expandState":"expand"},"children":[]},{"data":{"id":"bst4h9i3wqw0","created":1553169054646,"text":"多表联合时on条件上最好设置索引，where也是同样","expandState":"expand"},"children":[]}]},{"data":{"id":"bst3ms6ypv40","created":1553166666042,"text":"优化","expandState":"expand"},"children":[{"data":{"id":"bst1bhzskfs0","created":1553160139615,"text":"索引选择要适当，过多和选择不当，反而会导致低效","note":"索引过多，一来可能产生索引碎片，二来每次对记录更新都要修改索引会增加成本，三是会增加查询优化和选择的时间","expandState":"expand"},"children":[]},{"data":{"id":"bst3mxrcelc0","created":1553166678158,"text":"可以考虑选择前缀索引","note":"即以字段前部分字符为索引，索引变短，可以减少索引文件大小、维护开销，提高索引效率\n```\n//选择col的前n个字符为索引\nalter table Table_Name add index (col(n));\n```","expandState":"expand"},"children":[]},{"data":{"id":"bst49cwy4xs0","created":1553168435160,"text":"使用覆盖索引进行查询，避免回表","expandState":"expand"},"children":[]}]}]}]},{"data":{"id":"bst4bfg3fyw0","created":1553168597400,"text":"覆盖索引与回表","expandState":"expand"},"children":[]},{"data":{"id":"bst4ck3ikww0","created":1553168685887,"text":"SQL注意项（待补充）","expandState":"expand"},"children":[{"data":{"id":"bst4cv2ql4g0","created":1553168709785,"text":"每次写sql查询时，通过explain命令看看有什么可以优化的地方","note":"![](https://user-gold-cdn.xitu.io/2018/8/5/1650a598885eeacb?imageslim)","hyperlink":null,"hyperlinkTitle":null,"image":"https://user-gold-cdn.xitu.io/2018/8/5/1650a598885eeacb?imageslim","imageTitle":"","imageSize":{"width":200,"height":24},"expandState":"expand"},"children":[]}]}]},"template":"right","theme":"fresh-blue-compat","version":"1.4.43"}